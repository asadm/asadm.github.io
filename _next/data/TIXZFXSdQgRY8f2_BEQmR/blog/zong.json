{"pageProps":{"frontMatter":{"title":"Zong 4G Hacked?","description":"TL;DR: Zong’s servers are compromised and are randomly serving ads to it’s internet customers. Read on!","date":"2016-09-09T08:44:56.935Z","categories":[],"keywords":[],"slug":"/@asadmemon/zong-4g-hacked-c4ca24b7966d"},"slug":"zong","mdxSource":{"compiledSource":"var h=Object.defineProperty,g=Object.defineProperties;var c=Object.getOwnPropertyDescriptors;var n=Object.getOwnPropertySymbols;var i=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;var p=(e,t,s)=>t in e?h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,a=(e,t)=>{for(var s in t||(t={}))i.call(t,s)&&p(e,s,t[s]);if(n)for(var s of n(t))r.call(t,s)&&p(e,s,t[s]);return e},l=(e,t)=>g(e,c(t));var d=(e,t)=>{var s={};for(var o in e)i.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(e!=null&&n)for(var o of n(e))t.indexOf(o)<0&&r.call(e,o)&&(s[o]=e[o]);return s};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(s){var o=s,{components:e}=o,t=d(o,[\"components\"]);return mdx(MDXLayout,l(a(a({},layoutProps),t),{components:e,mdxType:\"MDXLayout\"}),mdx(\"p\",null,mdx(\"img\",a({parentName:\"p\"},{src:\"/assets/blog/old_posts/0__BGesPt3Oz0kAIBAA.png\",alt:null}))),mdx(\"p\",null,\"TL;DR: Zong\\u2019s servers are compromised and are randomly serving ads to it\\u2019s internet customers. Read on!\"),mdx(\"p\",null,\"I am addicted to Zong\\u2019s high speed internet and don\\u2019t plan on going back to PTCL again. But that doesn\\u2019t mean Zong is perfect.\"),mdx(\"p\",null,\"For sometime now, whenever I visit a website that is not on https, I am randomly redirected to some ad and a cycle of redirections start. Here is an example:\"),mdx(\"p\",null,mdx(\"img\",a({parentName:\"p\"},{src:\"/assets/blog/old_posts/0__RNTlbBZCYOpn8Z__l.gif\",alt:null}))),mdx(\"p\",null,\"I came to know that I am not alone. Here is one thread in a Facebook group:\"),mdx(\"p\",null,mdx(\"img\",a({parentName:\"p\"},{src:\"/assets/blog/old_posts/0__2UGgTrzvDctzuUXG.png\",alt:null}))),mdx(\"p\",null,\"It looks like a Zong specific problem. Let\\u2019s dig in.\"),mdx(\"h3\",null,\"How?\"),mdx(\"p\",null,\"I started looking at the page source of infected websites and quickly discovered that someone was replacing \",mdx(\"strong\",{parentName:\"p\"},\"Google Analytics\"),\" script with their own. This only works when the script is loaded over http. A Man-in-the-middle attack.\"),mdx(\"p\",null,\"Here is how google analytics is usually added in the site:\"),mdx(\"p\",null,mdx(\"img\",a({parentName:\"p\"},{src:\"/assets/blog/old_posts/0__u__QFN2kk2GJqdk4n.png\",alt:null}))),mdx(\"p\",null,\"But if that script is bad, it\\u2019s a disaster:\"),mdx(\"p\",null,mdx(\"img\",a({parentName:\"p\"},{src:\"/assets/blog/old_posts/0__Gs8HgQB0lASmQjPN.png\",alt:null}))),mdx(\"p\",null,\"It\\u2019s not hard to guess that this attack is happening somewhere inside the Zong empire. Since Zong has \",mdx(\"a\",a({parentName:\"p\"},{href:\"http://t.umblr.com/redirect?z=https%3A%2F%2Fwww.techjuice.pk%2Falert-zong-is-intercepting-web-traffic-to-install-scripts-on-websites%2F&t=NjhkOGY3NDk0YTRmNmFmNTg2MzIwZjViOTA0OWY3ZjRhNjM4NjE3ZiwyUkRIc3RiVg%3D%3D\"}),\"previously been injecting a toolbar too\"),\".\"),mdx(\"p\",null,\"Notice the \",mdx(\"strong\",{parentName:\"p\"},\"Server\"),\" in response headers. I don\\u2019t think Google would ever use \",mdx(\"em\",{parentName:\"p\"},\"Microsoft-IIS\"),\" to serve their analytics code:\"),mdx(\"p\",null,mdx(\"img\",a({parentName:\"p\"},{src:\"/assets/blog/old_posts/0__vcrjRvwsBiaZi__yF.png\",alt:null}))),mdx(\"h3\",null,\"Follow The\\xA0Money\"),mdx(\"p\",null,\"After a few \",mdx(\"em\",{parentName:\"p\"},\"traceroutes\"),\" It\\u2019s pretty clear that this is not DNS cache poisoning and is infact a page-rewrite attack. Also, Zong is not doing this intentionally. Someone has either hacked their servers or an employee has acted on their own.\"),mdx(\"p\",null,\"So let\\u2019s find out who owns these ads.\"),mdx(\"p\",null,\"Notice the above code, the \",mdx(\"strong\",{parentName:\"p\"},\"analytics.js\"),\" script further loads another script (either a.js or b.js based on what type of device you are using). Here is a snippet from \",mdx(\"strong\",{parentName:\"p\"},\"b.js\"),\":\"),mdx(\"p\",null,mdx(\"img\",a({parentName:\"p\"},{src:\"/assets/blog/old_posts/0__xExc9wwXISUbjK83.png\",alt:null}))),mdx(\"p\",null,\"Line 1 is what causes all those frustrating redirects. The page redirects to \",mdx(\"strong\",{parentName:\"p\"},\"geo-tv.us\"),\" domain which further redirects to ads.\"),mdx(\"p\",null,\"Here is a WHOIS snapshot of that domain:\"),mdx(\"p\",null,mdx(\"img\",a({parentName:\"p\"},{src:\"/assets/blog/old_posts/0__K9dGaxZPky3mnunk.png\",alt:null}))),mdx(\"p\",null,\"At this point, I would like to say that \",mdx(\"strong\",{parentName:\"p\"},\"my aim is not to put a blame on this domain\\u2019s owner\"),\". But he is probably getting loads of traffic to his website and I don\\u2019t think he wouldn\\u2019t have noticed that.\"),mdx(\"h3\",null,\"How Do I Fix\\xA0This?\"),mdx(\"p\",null,\"The bad news is, there is no fix for this! Only and only Zong can put an end to this and frankly their customer service staff is complete dumb in this regard.\"),mdx(\"p\",null,mdx(\"del\",{parentName:\"p\"},mdx(\"a\",a({parentName:\"del\"},{href:\"http://t.umblr.com/redirect?z=https%3A%2F%2Fgist.github.com%2Fasadm%2Fb74427cd09968352b84dabd214b840d7&t=ZWVkNWVkMDE2MWE0MjE1ZjNhYzAwZDU2ODFhY2YzY2Y4NTcyMTdjYSwyUkRIc3RiVg%3D%3D\"}),\"Here is a mirror of all scripts discussed above.\"))),mdx(\"p\",null,\"Thanks\"))}MDXContent.isMDXComponent=!0;\n","scope":{}},"readingTime":2},"__N_SSG":true}