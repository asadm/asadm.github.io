<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Zong 4G Hacked? – Asad Memon</title><meta name="description" content="Asad Memon&#x27;s homepage."/><meta property="og:title" content="Zong 4G Hacked? – Asad Memon"/><meta property="og:type" content="article"/><meta property="og:url" content="https://asadmemon.comundefined"/><link rel="apple-touch-icon" href="/assets/favicon.png"/><link rel="shortcut icon" href="/assets/favicon.png"/><meta property="og:image" content="https://asadmemon.com/assets/img/main1.jpg"/><meta property="og:description" content="Asad Memon&#x27;s homepage."/><a href="//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,500" rel="stylesheet" type="text/css"></a><meta name="viewport" content="width=device-width, initial-scale=0.8"/><script>
// Head scripts for the site

// google analytics
(function (i, s, o, g, r, a, m) {
  i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
    (i[r].q = i[r].q || []).push(arguments)
  }, i[r].l = 1 * new Date(); a = s.createElement(o),
    m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
  })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

  ga('create', 'UA-58030862-1', 'auto');
  ga('send', 'pageview');

// heap analytics
window.heap = window.heap || [], heap.load = function (e, t) { window.heap.appid = e, window.heap.config = t = t || {}; var r = t.forceSSL || "https:" === document.location.protocol, a = document.createElement("script"); a.type = "text/javascript", a.async = !0, a.src = (r ? "https:" : "http:") + "//cdn.heapanalytics.com/js/heap-" + e + ".js"; var n = document.getElementsByTagName("script")[0]; n.parentNode.insertBefore(a, n); for (var o = function (e) { return function () { heap.push([e].concat(Array.prototype.slice.call(arguments, 0))) } }, p = ["addEventProperties", "addUserProperties", "clearEventProperties", "identify", "removeEventProperty", "setEventProperties", "track", "unsetEventProperty"], c = 0; c < p.length; c++)heap[p[c]] = o(p[c]) };
heap.load("1855799973");
</script><meta name="next-head-count" content="13"/><link rel="preload" href="/_next/static/css/7475da46e5681ddd.css" as="style"/><link rel="stylesheet" href="/_next/static/css/7475da46e5681ddd.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-597d285740f0a5b3.js" defer=""></script><script src="/_next/static/chunks/framework-0f8b31729833af61.js" defer=""></script><script src="/_next/static/chunks/main-fd67a91ddc57a058.js" defer=""></script><script src="/_next/static/chunks/pages/_app-95a924f6848c8568.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-4d2f0a9f494a9dad.js" defer=""></script><script src="/_next/static/chunks/340-56639cdc358f7fa2.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-db05859b88c53380.js" defer=""></script><script src="/_next/static/SLYtjfGzwa01jAaewxQjg/_buildManifest.js" defer=""></script><script src="/_next/static/SLYtjfGzwa01jAaewxQjg/_ssgManifest.js" defer=""></script><script src="/_next/static/SLYtjfGzwa01jAaewxQjg/_middlewareManifest.js" defer=""></script></head><body><div class="container"><h1 id="logo" class="text-center"><a href="/">Asad<b>Memon</b></a></h1><ul class="menu"><li><a href="/projects">All Projects</a></li><li><a href="/talks">Talks</a></li><li><a href="/blog">Blog</a></li><li><a target="_blank" href="https://asad.substack.com/">Newsletter</a></li><li><a target="_blank" href="https://github.com/asadm">Github</a></li><li><a target="_blank" href="https://www.linkedin.com/in/memonasad/">LinkedIn</a></li><li><a target="_blank" href="http://instagram.com/snapmemon">Instagram</a></li></ul><div id="__next"><div class="mt-4 blog"><h1>Zong 4G Hacked?</h1><div class="meta"><div class="subscribe-text"><a class="" href="/blog/">Back</a> | <a href="/feed.xml">Subscribe with RSS</a> or <a href="https://feedly.com/i/subscription/feed%2Fhttps%3A%2F%2Fasadmemon.com%2Ffeed.xml">via Feedly</a>.</div><br/><span class="date" title="Friday, September 9th 2016">7 years ago<!-- --> | <!-- -->2<!-- --> min read</span></div><p><img src="/assets/blog/old_posts/0__BGesPt3Oz0kAIBAA.png"/></p><p>TL;DR: Zong’s servers are compromised and are randomly serving ads to it’s internet customers. Read on!</p><p>I am addicted to Zong’s high speed internet and don’t plan on going back to PTCL again. But that doesn’t mean Zong is perfect.</p><p>For sometime now, whenever I visit a website that is not on https, I am randomly redirected to some ad and a cycle of redirections start. Here is an example:</p><p><img src="/assets/blog/old_posts/0__RNTlbBZCYOpn8Z__l.gif"/></p><p>I came to know that I am not alone. Here is one thread in a Facebook group:</p><p><img src="/assets/blog/old_posts/0__2UGgTrzvDctzuUXG.png"/></p><p>It looks like a Zong specific problem. Let’s dig in.</p><h3>How?</h3><p>I started looking at the page source of infected websites and quickly discovered that someone was replacing <strong>Google Analytics</strong> script with their own. This only works when the script is loaded over http. A Man-in-the-middle attack.</p><p>Here is how google analytics is usually added in the site:</p><p><img src="/assets/blog/old_posts/0__u__QFN2kk2GJqdk4n.png"/></p><p>But if that script is bad, it’s a disaster:</p><p><img src="/assets/blog/old_posts/0__Gs8HgQB0lASmQjPN.png"/></p><p>It’s not hard to guess that this attack is happening somewhere inside the Zong empire. Since Zong has <a href="http://t.umblr.com/redirect?z=https%3A%2F%2Fwww.techjuice.pk%2Falert-zong-is-intercepting-web-traffic-to-install-scripts-on-websites%2F&amp;t=NjhkOGY3NDk0YTRmNmFmNTg2MzIwZjViOTA0OWY3ZjRhNjM4NjE3ZiwyUkRIc3RiVg%3D%3D">previously been injecting a toolbar too</a>.</p><p>Notice the <strong>Server</strong> in response headers. I don’t think Google would ever use <em>Microsoft-IIS</em> to serve their analytics code:</p><p><img src="/assets/blog/old_posts/0__vcrjRvwsBiaZi__yF.png"/></p><h3>Follow The Money</h3><p>After a few <em>traceroutes</em> It’s pretty clear that this is not DNS cache poisoning and is infact a page-rewrite attack. Also, Zong is not doing this intentionally. Someone has either hacked their servers or an employee has acted on their own.</p><p>So let’s find out who owns these ads.</p><p>Notice the above code, the <strong>analytics.js</strong> script further loads another script (either a.js or b.js based on what type of device you are using). Here is a snippet from <strong>b.js</strong>:</p><p><img src="/assets/blog/old_posts/0__xExc9wwXISUbjK83.png"/></p><p>Line 1 is what causes all those frustrating redirects. The page redirects to <strong>geo-tv.us</strong> domain which further redirects to ads.</p><p>Here is a WHOIS snapshot of that domain:</p><p><img src="/assets/blog/old_posts/0__K9dGaxZPky3mnunk.png"/></p><p>At this point, I would like to say that <strong>my aim is not to put a blame on this domain’s owner</strong>. But he is probably getting loads of traffic to his website and I don’t think he wouldn’t have noticed that.</p><h3>How Do I Fix This?</h3><p>The bad news is, there is no fix for this! Only and only Zong can put an end to this and frankly their customer service staff is complete dumb in this regard.</p><p><del><a href="http://t.umblr.com/redirect?z=https%3A%2F%2Fgist.github.com%2Fasadm%2Fb74427cd09968352b84dabd214b840d7&amp;t=ZWVkNWVkMDE2MWE0MjE1ZjNhYzAwZDU2ODFhY2YzY2Y4NTcyMTdjYSwyUkRIc3RiVg%3D%3D">Here is a mirror of all scripts discussed above.</a></del></p><p>Thanks</p></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontMatter":{"title":"Zong 4G Hacked?","description":"TL;DR: Zong’s servers are compromised and are randomly serving ads to it’s internet customers. Read on!","date":"2016-09-09T08:44:56.935Z","categories":[],"keywords":[],"slug":"/@asadmemon/zong-4g-hacked-c4ca24b7966d"},"slug":"zong","mdxSource":{"compiledSource":"var h=Object.defineProperty,g=Object.defineProperties;var c=Object.getOwnPropertyDescriptors;var n=Object.getOwnPropertySymbols;var i=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;var p=(e,t,s)=\u003et in e?h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,a=(e,t)=\u003e{for(var s in t||(t={}))i.call(t,s)\u0026\u0026p(e,s,t[s]);if(n)for(var s of n(t))r.call(t,s)\u0026\u0026p(e,s,t[s]);return e},l=(e,t)=\u003eg(e,c(t));var d=(e,t)=\u003e{var s={};for(var o in e)i.call(e,o)\u0026\u0026t.indexOf(o)\u003c0\u0026\u0026(s[o]=e[o]);if(e!=null\u0026\u0026n)for(var o of n(e))t.indexOf(o)\u003c0\u0026\u0026r.call(e,o)\u0026\u0026(s[o]=e[o]);return s};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(s){var o=s,{components:e}=o,t=d(o,[\"components\"]);return mdx(MDXLayout,l(a(a({},layoutProps),t),{components:e,mdxType:\"MDXLayout\"}),mdx(\"p\",null,mdx(\"img\",a({parentName:\"p\"},{src:\"/assets/blog/old_posts/0__BGesPt3Oz0kAIBAA.png\",alt:null}))),mdx(\"p\",null,\"TL;DR: Zong\\u2019s servers are compromised and are randomly serving ads to it\\u2019s internet customers. Read on!\"),mdx(\"p\",null,\"I am addicted to Zong\\u2019s high speed internet and don\\u2019t plan on going back to PTCL again. But that doesn\\u2019t mean Zong is perfect.\"),mdx(\"p\",null,\"For sometime now, whenever I visit a website that is not on https, I am randomly redirected to some ad and a cycle of redirections start. Here is an example:\"),mdx(\"p\",null,mdx(\"img\",a({parentName:\"p\"},{src:\"/assets/blog/old_posts/0__RNTlbBZCYOpn8Z__l.gif\",alt:null}))),mdx(\"p\",null,\"I came to know that I am not alone. Here is one thread in a Facebook group:\"),mdx(\"p\",null,mdx(\"img\",a({parentName:\"p\"},{src:\"/assets/blog/old_posts/0__2UGgTrzvDctzuUXG.png\",alt:null}))),mdx(\"p\",null,\"It looks like a Zong specific problem. Let\\u2019s dig in.\"),mdx(\"h3\",null,\"How?\"),mdx(\"p\",null,\"I started looking at the page source of infected websites and quickly discovered that someone was replacing \",mdx(\"strong\",{parentName:\"p\"},\"Google Analytics\"),\" script with their own. This only works when the script is loaded over http. A Man-in-the-middle attack.\"),mdx(\"p\",null,\"Here is how google analytics is usually added in the site:\"),mdx(\"p\",null,mdx(\"img\",a({parentName:\"p\"},{src:\"/assets/blog/old_posts/0__u__QFN2kk2GJqdk4n.png\",alt:null}))),mdx(\"p\",null,\"But if that script is bad, it\\u2019s a disaster:\"),mdx(\"p\",null,mdx(\"img\",a({parentName:\"p\"},{src:\"/assets/blog/old_posts/0__Gs8HgQB0lASmQjPN.png\",alt:null}))),mdx(\"p\",null,\"It\\u2019s not hard to guess that this attack is happening somewhere inside the Zong empire. Since Zong has \",mdx(\"a\",a({parentName:\"p\"},{href:\"http://t.umblr.com/redirect?z=https%3A%2F%2Fwww.techjuice.pk%2Falert-zong-is-intercepting-web-traffic-to-install-scripts-on-websites%2F\u0026t=NjhkOGY3NDk0YTRmNmFmNTg2MzIwZjViOTA0OWY3ZjRhNjM4NjE3ZiwyUkRIc3RiVg%3D%3D\"}),\"previously been injecting a toolbar too\"),\".\"),mdx(\"p\",null,\"Notice the \",mdx(\"strong\",{parentName:\"p\"},\"Server\"),\" in response headers. I don\\u2019t think Google would ever use \",mdx(\"em\",{parentName:\"p\"},\"Microsoft-IIS\"),\" to serve their analytics code:\"),mdx(\"p\",null,mdx(\"img\",a({parentName:\"p\"},{src:\"/assets/blog/old_posts/0__vcrjRvwsBiaZi__yF.png\",alt:null}))),mdx(\"h3\",null,\"Follow The\\xA0Money\"),mdx(\"p\",null,\"After a few \",mdx(\"em\",{parentName:\"p\"},\"traceroutes\"),\" It\\u2019s pretty clear that this is not DNS cache poisoning and is infact a page-rewrite attack. Also, Zong is not doing this intentionally. Someone has either hacked their servers or an employee has acted on their own.\"),mdx(\"p\",null,\"So let\\u2019s find out who owns these ads.\"),mdx(\"p\",null,\"Notice the above code, the \",mdx(\"strong\",{parentName:\"p\"},\"analytics.js\"),\" script further loads another script (either a.js or b.js based on what type of device you are using). Here is a snippet from \",mdx(\"strong\",{parentName:\"p\"},\"b.js\"),\":\"),mdx(\"p\",null,mdx(\"img\",a({parentName:\"p\"},{src:\"/assets/blog/old_posts/0__xExc9wwXISUbjK83.png\",alt:null}))),mdx(\"p\",null,\"Line 1 is what causes all those frustrating redirects. The page redirects to \",mdx(\"strong\",{parentName:\"p\"},\"geo-tv.us\"),\" domain which further redirects to ads.\"),mdx(\"p\",null,\"Here is a WHOIS snapshot of that domain:\"),mdx(\"p\",null,mdx(\"img\",a({parentName:\"p\"},{src:\"/assets/blog/old_posts/0__K9dGaxZPky3mnunk.png\",alt:null}))),mdx(\"p\",null,\"At this point, I would like to say that \",mdx(\"strong\",{parentName:\"p\"},\"my aim is not to put a blame on this domain\\u2019s owner\"),\". But he is probably getting loads of traffic to his website and I don\\u2019t think he wouldn\\u2019t have noticed that.\"),mdx(\"h3\",null,\"How Do I Fix\\xA0This?\"),mdx(\"p\",null,\"The bad news is, there is no fix for this! Only and only Zong can put an end to this and frankly their customer service staff is complete dumb in this regard.\"),mdx(\"p\",null,mdx(\"del\",{parentName:\"p\"},mdx(\"a\",a({parentName:\"del\"},{href:\"http://t.umblr.com/redirect?z=https%3A%2F%2Fgist.github.com%2Fasadm%2Fb74427cd09968352b84dabd214b840d7\u0026t=ZWVkNWVkMDE2MWE0MjE1ZjNhYzAwZDU2ODFhY2YzY2Y4NTcyMTdjYSwyUkRIc3RiVg%3D%3D\"}),\"Here is a mirror of all scripts discussed above.\"))),mdx(\"p\",null,\"Thanks\"))}MDXContent.isMDXComponent=!0;\n","scope":{}},"readingTime":2},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"zong"},"buildId":"SLYtjfGzwa01jAaewxQjg","isFallback":false,"gsp":true,"scriptLoader":[]}</script><div class="footer"><p>AsadMemon.com [<a href="https://github.com/asadm/asadm.github.io" target="_blank">source code</a>].</p></div></div></body></html>